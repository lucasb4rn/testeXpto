create table PRODUTO (
   IDPRODUTO number not null,
   CODIGOINTERNO varchar2(60) not null,
   DESCR varchar2(120) not null,
   ATIVO char(1) DEFAULT 'S' not null,
   CONSTRAINT produto_pk 
   PRIMARY KEY (IDPRODUTO)
);

insert into produto (IDPRODUTO, CODIGOINTERNO, DESCR, ATIVO) values (12, 000001, 'OLEO DE SOJA', 'S');
insert into produto (IDPRODUTO, CODIGOINTERNO, DESCR, ATIVO) values (13, 000001, 'OLEO DE GIRASSOL', 'S');
insert into produto (IDPRODUTO, CODIGOINTERNO, DESCR, ATIVO) values (57, 000001, 'TELEFONE SEM FIO', 'S');
insert into produto (IDPRODUTO, CODIGOINTERNO, DESCR, ATIVO) values (382, 000001, 'MOUSE MICROSFT', 'S');
insert into produto (IDPRODUTO, CODIGOINTERNO, DESCR, ATIVO) values (435, 000001, 'JOHNNIE WALKER BLUE LABEL', 'S');


create table EMBALAGEM (
   IDPRODUTO number not null,
   BARRA varchar2(32) not null,
   DESCR varchar2(80) not null,
   FATORCONVERSAO number not null,
   ALTURA number DEFAULT 0,
   LARGURA number DEFAULT 0,
   COMPRIMENTO number,
   ATIVO char(1) DEFAULT 'S' not null,
   CONSTRAINT fk_produto 
   PRIMARY KEY (IDPRODUTO, BARRA)
);

insert into embalagem (IDPRODUTO, BARRA, DESCR, FATORCONVERSAO, ALTURA, LARGURA, COMPRIMENTO, ATIVO) values (12,7891000315507,'OLEO DE SOJA LT',1,200,100,100,'S');					
insert into embalagem (IDPRODUTO, BARRA, DESCR, FATORCONVERSAO, ALTURA, LARGURA, COMPRIMENTO, ATIVO) values (12,7891000315508,'OLEO DE SOJA CX COM 10',10,250,400,400,'S');					
insert into embalagem (IDPRODUTO, BARRA, DESCR, FATORCONVERSAO, ALTURA, LARGURA, COMPRIMENTO, ATIVO) values (13,7891000415510,'OLEO DE GIRASSOL LT',1,200,100,100,'S');					
insert into embalagem (IDPRODUTO, BARRA, DESCR, FATORCONVERSAO, ALTURA, LARGURA, COMPRIMENTO, ATIVO) values (13,7891000415511,'OLEO DE GIRASSOL CX COM 10',10,250,400,400,'S');					
insert into embalagem (IDPRODUTO, BARRA, DESCR, FATORCONVERSAO, ALTURA, LARGURA, COMPRIMENTO, ATIVO) values (57,7891000415515,'TELEFONE SEM FIO',1,170,180,190,'S');					
insert into embalagem (IDPRODUTO, BARRA, DESCR, FATORCONVERSAO, ALTURA, LARGURA, COMPRIMENTO, ATIVO) values (382,7891000715501,'MOUSE MICROSOFT',1,60,60,110,'S');					
insert into embalagem (IDPRODUTO, BARRA, DESCR, FATORCONVERSAO, ALTURA, LARGURA, COMPRIMENTO, ATIVO) values (382,7891000715502,'MOUSE MICROSOFT CX COM 10',10,180,200,200,'S');					
insert into embalagem (IDPRODUTO, BARRA, DESCR, FATORCONVERSAO, ALTURA, LARGURA, COMPRIMENTO, ATIVO) values (382,7891000715503,'MOUSE MICROSOFT CX COM 50',50,400,450,450,'N');					
insert into embalagem (IDPRODUTO, BARRA, DESCR, FATORCONVERSAO, ALTURA, LARGURA, COMPRIMENTO, ATIVO) values (435,7891000745678,'JOHNNIE WALKER BLUE LABEL',1,300,150,150,'S');					
insert into embalagem (IDPRODUTO, BARRA, DESCR, FATORCONVERSAO, ALTURA, LARGURA, COMPRIMENTO, ATIVO) values (435,7891000745679,'JOHNNIE WALKER BLUE LABEL CX COM 12',12,350,450,450,'S');


--EXERCÍCIO A
SELECT * FROM PRODUTO WHERE ROWNUM <= 10

--EXERCÍCIO B
SELECT P.* FROM PRODUTO P INNER JOIN EMBALAGEM E ON E.IDPRODUTO = P.IDPRODUTO AND E.ativo = 'S'

--EXERCÍCIO C
SELECT P.IDPRODUTO, sum(E.FATORCONVERSAO) as QUANTIDADE FROM PRODUTO P INNER JOIN EMBALAGEM E ON E.IDPRODUTO = P.IDPRODUTO group by P.IDPRODUTO

--EXERCICIO D
insert into PRODUTO (IDPRODUTO, CODIGOINTERNO, DESCR, ATIVO) values (60, 000001, 'CHOCOLATE BARRA', 'S');
insert into EMBALAGEM (IDPRODUTO, BARRA, DESCR, FATORCONVERSAO, ALTURA, LARGURA, COMPRIMENTO, ATIVO) values (60,7891000745679,'CHOCOLATE BARRA',5,50,10,50,'S');

--EXERCÍCIO E
UPDATE EMBALAGEM SET ALTURA = 250, LARGURA = 120, COMPRIMENTO = 150 WHERE FATORCONVERSAO = 1